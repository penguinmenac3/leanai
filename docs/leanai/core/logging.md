[Back to Overview](../../README.md)



# leanai.core.logging

> Logging for tensorflow and pytorch.

## Outline

This package helps with logging while training and managing checkpoints (creation, eta estimation, etc.).

1. Global Flags
2. Time Helpers
3. Logging




# Global Flags

These flags allow controlling what gets printed when using status, info, warn and error function. Debug verbosity enables a lot of logging leanai internally.

```python
DEBUG_VERBOSITY = False
PRINT_STATUS = True
PRINT_INFO = True
PRINT_WARN = True
PRINT_ERROR = True
```

For logging the code an ignore list is used to find out what files to ignore. If you need to change those files you can modify the following global variable of this module, before setting up the logger.

```python
PYTHON_IGNORE_LIST = ["__pycache__", "*.pyc", ".ipynb_checkpoints", "checkpoints", "logs", "dist", "docs", "*.egg-info", "tfrecords", "*.code-workspace", ".git"]
```

For example:

```python
from leanai.core import logging
logging.PYTHON_IGNORE_LIST.append("*.my_extension")
logging.set_logger("...")
```




# Time Helpers

These functions help handling time formating and computations.


---
### *def* **format_time**(t: float) -> str

Format a time duration in a readable format.

* **t**: The duration in seconds.
* **returns**: A human readable string.


---
### *def* **get_timestamp**() -> str

Create a string for the current timestamp.

* **returns**: Current date and time as a string suitable for a logfolder filename.


---
### *def* **compute_eta**(progress, last_progress, last_update)

Compute the ETA.

Uses the current timestamp the last_update and the difference between progresses to estimate the remaining time.

* **progress**: The current progress (between 0 and 1).
* **last_progress**: The progress measured at the last step (between 0 and 1).
* **last_update**: The timestamp when the last progress was measured.




# Logging


---
### *def* **set_logger**(log_file: str) -> None

Setup the logger.

Creates the log folder, a src folder inside the log folder where it copies the current working directory.

* **log_file**: File where the warns, errors, etc. should be written. The folder in which the log file is is used for checkpointing.


---
### *def* **close**(reason: str = None) -> None

Close the logger for a given reason.

If none is provided there is no final progress written. Provide a reason, if you do not manually set the final progress before.
A training loop typically manually sets the progress, so you will not need a reason in that case.

* **reason**: The reason for the closing of the logger. It is recommended to use "done", "paused", "failed" as reason.


---
### *def* **get_log_path**() -> Union[str, None]

Gets the log path based on the logfile.

* **returns**: The path containing the logfile.


---
### *def* **create_checkpoint_structure**() -> None

Create a checkpoint structure in the log folder.

* train: Folder for train split tensorboard logs.
* val: Folder for val split tensorboard logs.
* test: Folder for test split tensorboard logs.
* checkpoints: Folder for the leanai, pytorch or tensorboard checkpoints.
* images: Folder for images that are generated by your code. (use log_image)


---
### *def* **log_progress**(goal: str, progress: float, score: Union[float, np.number]) -> None

Update the progress value. Automatically also computes the ETA and updates it in the logs.

* **goal**: The current goal it tries to reach. ("training", "validating", "pause", "waiting", "done")
* **progress**: A value between 0 and 1 indicating the progress, where 1 means done. The value should grow monotonic.
* **score**: The score that the approach achieved.


---
### *def* **log_image**(*, name: str, data: np.ndarray = None) -> None

Log an image.

* **name**: The name of the image (e.g. "example.png").
* **data**: The data (optional) if none is provided it is assumed that a pyplot figure should be saved.


---
### *def* **status**(msg: str, end: str = "\n") -> None

Print something with a timestamp.
Useful for logging.
Leanai internally uses this for all its log messages.

* **msg**: The message to print.
* **end**: The line ending. Defaults to "\n" but can be set to "" to not have a linebreak.


---
### *def* **info**(msg: str, end: str= "\n") -> None

Print something with a timestamp.
Useful for logging.
Leanai internally uses this for all its log messages.

* **msg**: The message to print.
* **end**: The line ending. Defaults to "\n" but can be set to "" to not have a linebreak.


---
### *def* **warn**(msg: str, end: str = "\n") -> None

Print something with a timestamp.
Useful for logging.
Leanai internally uses this for all its log messages.

* **msg**: The message to print.
* **end**: The line ending. Defaults to "\n" but can be set to "" to not have a linebreak.


---
### *def* **debug**(msg: str, end: str = "\n") -> None

Print something with a timestamp.
Useful for logging.
Leanai internally uses this for all its log messages.

* **msg**: The message to print.
* **end**: The line ending. Defaults to "\n" but can be set to "" to not have a linebreak.


---
### *def* **error**(msg: str, end: str = "\n") -> None

Print something with a timestamp.
Useful for logging.
Leanai internally uses this for all its log messages.

* **msg**: The message to print.
* **end**: The line ending. Defaults to "\n" but can be set to "" to not have a linebreak.


